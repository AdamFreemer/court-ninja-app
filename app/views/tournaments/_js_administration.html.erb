<script>
  function display(court) {
    if (court == 'all') {
      window.open("/tournaments/display_multiple/<%= @tournament.id %>/<%= round %>")
    } else {
      window.open("/tournaments/display_single/<%= @tournament.id %>/<%= round %>/" + court)
    }
  };

  function updateScores(finalize) {
    var score_data = $('input[name^=team-]').map(function(idx, elem) {
      return { team_id: $(elem).attr('id'), score: $(elem).val() }
    }).get();

    event.preventDefault();

    $.ajax({
        type: "POST",
        url: "/tournaments/<%= @tournament.id %>/team_scores_update",
        beforeSend: function(jqXHR, settings) {
          jqXHR.setRequestHeader('X-CSRF-Token', $('meta[name="csrf-token"]').attr('content'));
        },
        data: { score_data, finalize },
        success: function (response) {
          if (finalize == 'update') {
            $('#update-scores').addClass("loading")
            location.reload();
          } else {
            $('#finalize-round').addClass("loading")
            window.location.href = "/tournament/process_round/<%= @tournament.id %>/<%= round %>";
          }
        }
    })
  };
</script>