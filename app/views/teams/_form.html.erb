<%= form_with(model: team, class: "contents") do |form| %>
  <% if team.errors.any? %>
    <div id="error_explanation" class="bg-red-50 text-red-500 px-3 py-2 font-medium rounded-lg mt-3">
      <h2><%= pluralize(team.errors.count, "error") %> prohibited this team from being saved:</h2>
      <ul>
        <% team.errors.each do |error| %>
          <li><%= error.full_message %></li>
        <% end %>
      </ul>
    </div>
  <% end %>

  <% if current_user.is_coach? %>
    <%= form.hidden_field :coach_id, value: current_user.id %>
  <% end %>

  <div class="bg-white px-4 py-5 sm:rounded-lg sm:p-6">
    <div class="py-4 w-full ">
      <label for="name" class="block text-sm font-medium text-gray-700">Team Name</label>
      <%= form.text_field :name, class: "mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md" %>
    </div>
    <div class="py-4">
      <label for="description" class="block text-sm font-medium text-gray-700">Description</label>
      <%= form.text_field :description, class: "mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md" %>
    </div>

    <% if !current_page?(new_team_path) %>
      <div class="form-check">
        <%= form.check_box :active, class: "w-4 h-4 rounded mx-0 ml-1 mr-1" %>
        <label class="form-check-label inline-block text-sm font-medium text-gray-70" for="active">Active?</label>
      </div>
      <%= render "coaches/players/index", team: team %>
    <% end %>

  </div>

  <div class="flex justify-end space-x-3">
    <%= link_to "Back to your dashboard", root_url, class: "inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500" %>
    <button type="submit" class="inline-flex items-center px-2.5 py-1.5 border border-transparent text-xs font-medium rounded text-indigo-700 bg-indigo-100 hover:bg-indigo-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">Save</button>
  </div>
<% end %>

<% if team.persisted? %>
<div id="popup-modal" tabindex="-1" class="hidden overflow-y-auto overflow-x-hidden fixed top-0 right-0 left-0 z-50 md:inset-0 h-modal md:h-full">
  <% athlete = User.new %>
  <div class="relative p-4 w-full max-w-md h-full md:h-auto">
    <div class="relative bg-white rounded-lg shadow dark:bg-gray-700">
      <button type="button" class="absolute top-3 right-2.5 text-gray-400 bg-transparent hover:bg-gray-200 hover:text-gray-900 rounded-lg text-sm p-1.5 ml-auto inline-flex items-center dark:hover:bg-gray-800 dark:hover:text-white" data-modal-toggle="popup-modal">
        <svg aria-hidden="true" class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>
        <span class="sr-only">Close modal</span>
      </button>
      <div class="p-6">

        <h2 class="font-bold">Add Athlete</h2>
        <%= form_for athlete, url: add_player_to_team_team_path(team.id), html: { method: :post }, remote: true do |f| %>
          <div class="py-4">
            <%= f.label :first_name, "First Name", class: "block text-sm" %>
            <%= f.text_field :first_name, autofocus: true, class: "w-full px-2 py-2 text-sm border rounded-md focus:border-blue-400 focus:outline-none focus:ring-1 focus:ring-blue-500" %>
          </div>
          <div class="pb-4">
            <%= f.label :last_name, "Last Name", class: "block text-sm" %>
            <%= f.text_field :last_name, class: "w-full px-2 py-2 text-sm border rounded-md focus:border-blue-400 focus:outline-none focus:ring-1 focus:ring-blue-500" %>
          </div>
          <div class="pb-4">
            <%= f.label :email, "Email", class: "block text-sm" %>
            <%= f.email_field :email, class: "w-full px-2 py-2 text-sm border rounded-md focus:border-blue-400 focus:outline-none focus:ring-1 focus:ring-blue-500" %>
          </div>
          <%= f.hidden_field :team_id, value: team.id %>
          <%= f.submit "Submit", class: "block w-full px-2 py-2 mt-4 text-sm font-medium leading-5 text-center text-white transition-colors duration-150 bg-blue-500 border border-transparent rounded-lg active:bg-blue-500 hover:bg-blue-700 focus:outline-none focus:shadow-outline-blue" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
<% end %>
